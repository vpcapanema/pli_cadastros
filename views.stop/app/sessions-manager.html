<!doctype html>
<html lang="pt-BR">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="SIGMA/PLI - Sistema de Gerenciamento de Cadastros" />
  <meta name="author" content="VPC-GEOSER" />
  <title>Gerenciamento de Sessões - SIGMA-PLI | Módulo de Gerenciamento de Cadastros</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&amp;display=swap"
    rel="stylesheet" />
  <link href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css" rel="stylesheet" />
  <link href="/static/css/individual/header.css" rel="stylesheet" />
  <link href="/static/css/individual/footer.css" rel="stylesheet" />
  <link href="/static/css/individual/sessions-manager.css" rel="stylesheet" />
  <script defer src="/static/js/auto/sessions-manager_auto.js"></script>
</head>

<body class="has-fixed-header p-sessions-manager">
  <script src="/static/js/auth-guard.js"></script>
  <!-- NavegaÃ§Ã£o Modularizada -->
  <div id="navbar-container"></div>
  <script src="/static/js/navbar-loader.js"></script>
  <!-- Main Content -->
  <div class="pli-main-content">
    <main class="container-fluid py-4">
      <!-- Header -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h1 class="h3 mb-1">
                <i class="fas fa-shield-alt text-primary"></i>
                Gerenciamento de Sessões
              </h1>
              <p class="text-muted mb-0">
                Monitore e gerencie todas as sessões ativas do
                <strong>SIGMA-PLI</strong>
              </p>
            </div>
            <div class="d-flex gap-2">
              <button class="btn btn-outline-primary" id="auto_evt_fb0076a4">
                <i class="fas fa-sync-alt"></i>
                Atualizar
              </button>
              <button class="btn btn-warning" id="auto_evt_14965b10">
                <i class="fas fa-broom"></i>
                Limpar Expiradas
              </button>
            </div>
          </div>
        </div>
      </div>
      <!-- Estatísticas -->
      <div class="row mb-4">
        <div class="col-md-3">
          <div class="card text-white bg-primary">
            <div class="card-body">
              <div class="d-flex align-items-center">
                <div class="flex-shrink-0">
                  <i class="fas fa-users fa-2x"></i>
                </div>
                <div class="flex-grow-1 ms-3">
                  <div class="small">Sessões Ativas</div>
                  <div class="h5 mb-0" id="stat-active-sessions">-</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card text-white bg-success">
            <div class="card-body">
              <div class="d-flex align-items-center">
                <div class="flex-shrink-0">
                  <i class="fas fa-user-friends fa-2x"></i>
                </div>
                <div class="flex-grow-1 ms-3">
                  <div class="small">Usuários Únicos</div>
                  <div class="h5 mb-0" id="stat-unique-users">-</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card text-white bg-info">
            <div class="card-body">
              <div class="d-flex align-items-center">
                <div class="flex-shrink-0">
                  <i class="fas fa-sign-in-alt fa-2x"></i>
                </div>
                <div class="flex-grow-1 ms-3">
                  <div class="small">Logins Hoje</div>
                  <div class="h5 mb-0" id="stat-logins-today">-</div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card text-white bg-warning">
            <div class="card-body">
              <div class="d-flex align-items-center">
                <div class="flex-shrink-0">
                  <i class="fas fa-clock fa-2x"></i>
                </div>
                <div class="flex-grow-1 ms-3">
                  <div class="small">Duração Média</div>
                  <div class="h5 mb-0" id="stat-avg-duration">- min</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Filtros -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              <h5 class="card-title mb-0">
                <i class="fas fa-filter"></i>
                Filtros
              </h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-3">
                  <label class="form-label" for="filter-status">Status</label>
                  <select aria-label="Filtrar por status" class="form-select" id="filter-status">
                    <option value="">Todos</option>
                    <option selected="" value="ATIVA">Ativas</option>
                    <option value="INATIVA">Inativas</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label class="form-label" for="filter-user-type">Tipo de Usuário</label>
                  <select aria-label="Filtrar por tipo de usuário" class="form-select" id="filter-user-type">
                    <option value="">Todos</option>
                    <option value="ADMIN">ADMIN</option>
                    <option value="GESTOR">GESTOR</option>
                    <option value="ANALISTA">ANALISTA</option>
                    <option value="OPERADOR">OPERADOR</option>
                  </select>
                </div>
                <div class="col-md-3">
                  <label class="form-label">Buscar Usuário</label>
                  <input class="form-control" id="filter-username" placeholder="Nome ou username" type="text" />
                </div>
                <div class="col-md-3">
                  <label class="form-label"> </label>
                  <div class="d-grid">
                    <button class="btn btn-primary" id="auto_evt_c80c3a47">
                      <i class="fas fa-search"></i>
                      Aplicar Filtros
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Tabela de Sessões -->
      <div class="row">
        <div class="col-12">
          <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h5 class="card-title mb-0">
                <i class="fas fa-list"></i>
                Sessões Ativas
              </h5>
              <div class="text-muted small">
                Atualizado em:
                <span id="last-update">-</span>
              </div>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-striped table-hover" id="sessionsTable">
                  <thead class="table-dark">
                    <tr>
                      <th>Status</th>
                      <th>Usuário</th>
                      <th>Tipo</th>
                      <th>Login</th>
                      <th>Último Acesso</th>
                      <th>IP</th>
                      <th>Dispositivo</th>
                      <th>Duração</th>
                      <th>Ações</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Dados carregados via JavaScript -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Modal de Detalhes da Sessão -->
  <div class="modal fade" id="sessionDetailsModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title">
            <i class="fas fa-info-circle me-2"></i>
            Detalhes da Sessão
          </h5>
          <button aria-label="Fechar modal" class="btn-close btn-close-white" data-bs-dismiss="modal"
            type="button"></button>
        </div>
        <div class="modal-body" id="session-details-content">
          <!-- Conteúdo carregado dinamicamente -->
        </div>
        <div class="modal-footer">
          <button class="btn btn-danger" id="btn-invalidate-session" type="button">
            <i class="fas fa-ban me-2"></i>
            Invalidar Sessão
          </button>
          <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Fechar</button>
        </div>
      </div>
    </div>
  </div>
  <!-- Footer Modularizado -->
  <div id="footer-container"></div>
  <script src="/static/js/footer-loader.js"></script>
  <!-- Scripts da aplicação -->
  <script src="/static/js/services/api.js"></script>
  <script src="/static/js/services/auth.js"></script>
  <script src="/static/js/services/utils.js"></script>
  <script src="/static/js/services/sessionMonitor.js"></script>
  <script src="/static/js/session-auto-init.js"></script>
  <script src="/static/js/components/notification.js"></script>
  <script src="/static/js/components/loading.js"></script>
  <script src="/static/js/components/statusBar.js"></script>
  <script src="/static/js/pages/sessions-manager.js"></script>
  <script src="/static/js/datatable-script-loader.js"></script>
</body>

</html>