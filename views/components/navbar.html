<link rel="stylesheet" href="/css/sistema_aplicacao_cores_pli.css">

<!-- NAVBAR 2: Usuário Logado - Demais Páginas -->

    <!-- Navegação -->
    <div id="navbar-container">
        <!-- O navbar será carregado aqui via JavaScript -->
    </div>
    
    <script>
        // Carrega o navbar compartilhado
        document.addEventListener('DOMContentLoaded', function() {
            fetch('/views/includes/navbars.html')
                .then(response => response.text())
                .then(html => {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    const navbar = doc.querySelector('#navbar-public');
                    document.getElementById('navbar-container').innerHTML = navbar.outerHTML;
                    
                    // Marca o link atual como ativo
                    const currentPath = window.location.pathname;
                    const filename = currentPath.split('/').pop();
                    if (filename) {
                        const navLink = document.querySelector(`#navbar-container .nav-link[href="${filename}"]`);
                        if (navLink) {
                            navLink.classList.add('active');
                        }
                    }
                })
                .catch(error => console.error('Erro ao carregar navbar:', error));
        });
    </script>


<!-- NAVBAR 3: Usuário Não Logado - Página Inicial -->
<nav class="navbar navbar-expand-lg pli-navbar" id="navbar-public">
    <div class="container">
        <a class="navbar-brand text-pli-azul-escuro" href="index.html">
            <i class="fas fa-building"></i> SIGMA-PLI | Módulo de Gerenciamento de Cadastros
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarPublic" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarPublic">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item">
                    <a class="nav-link" href="index.html">
                        <i class="fas fa-home"></i> Início
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="pessoa-fisica.html">
                        <i class="fas fa-user"></i> Pessoa Física
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="pessoa-juridica.html">
                        <i class="fas fa-building"></i> Pessoa Jurídica
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="usuarios.html">
                        <i class="fas fa-users"></i> Usuários
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="recursos.html">
                        <i class="fas fa-cogs"></i> Recursos
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="sobre.html">
                        <i class="fas fa-info-circle"></i> Sobre
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link btn-pli-confirm ms-2 px-3" href="login.html">
                        <i class="fas fa-sign-in-alt"></i> Acesso ao Sistema
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<script>
function logout() {
    if (confirm('Deseja realmente sair do sistema?')) {
        // Limpar dados do localStorage/sessionStorage
        localStorage.removeItem('userToken');
        localStorage.removeItem('userData');
        sessionStorage.clear();
        // Fazer logout na API
        fetch('/api/auth/logout', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer ' + localStorage.getItem('userToken')
            }
        }).finally(() => {
            window.location.href = 'index.html';
        });
    }
}

// Função para carregar nome do usuário logado
function loadUserName() {
    const userData = JSON.parse(localStorage.getItem('userData') || '{}');
    const userNameElements = document.querySelectorAll('#userName, #userNameInternal');
    userNameElements.forEach(element => {
        if (element) {
            element.textContent = userData.nome || 'Usuário';
        }
    });
}

// Carregar nome do usuário quando a página carregar
document.addEventListener('DOMContentLoaded', loadUserName);
</script>
